/* Styles adapted for final v2 */
:root{ --bg:#0f1225; --panel:#15193a; --panel-2:#1b2050; --text:#e8ebff; --muted:#aab0d6; --accent:#9ab0ff; --danger:#ff6b6b; --shadow:0 10px 30px rgba(0,0,0,.25); }
html,body,#app{height:100%;}
body{ margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; color:var(--text); background: radial-gradient(1200px 800px at 60% -20%, #202a78 0%, #0f1225 50%, #0c0f1e 100%); }
#app{display:flex;gap:12px;padding:12px;box-sizing:border-box; align-items:stretch;}
#sidebar{ width:360px; min-width:160px; max-width:900px; background:linear-gradient(180deg,var(--panel), var(--panel-2)); border-radius:14px; padding:10px; box-shadow:var(--shadow); overflow:auto; }
.sidebar-title{ list-style:none; padding:8px; margin:0 0 8px 0; cursor:default; color:var(--accent); font-weight:600; }
.section{ border:1px solid rgba(255,255,255,.06); border-radius:12px; padding:8px; margin-bottom:12px; background:rgba(255,255,255,.02); }
.section summary{ cursor:pointer; font-weight:600; color:var(--accent); margin-bottom:6px; }
.controls{ display:flex; flex-direction:column; gap:8px; }
.row{ display:flex; gap:8px; align-items:center; }
.right{ justify-content:flex-end; }
.help{ margin:0 0 0 16px; color:var(--muted); font-size:13px; }
#canvas-wrap{ flex:1; position:relative; border-radius:12px; overflow:hidden; box-shadow:var(--shadow); background:rgba(255,255,255,.02); }
#canvas{ width:100%; height:100%; display:block; background-image: radial-gradient(rgba(255,255,255,.06) 1px, transparent 1px), radial-gradient(rgba(255,255,255,.04) 1px, transparent 1px); background-position: 0 0, 25px 25px; background-size: 50px 50px; }
button, input, select, label.file-btn{ background:#232857; color:var(--text); border:1px solid rgba(255,255,255,.12); border-radius:10px; padding:8px 10px; font-size:13px; }
label.file-btn{ position:relative; display:inline-flex; align-items:center; gap:8px; cursor:pointer; }
label.file-btn input{ position:absolute; inset:0; opacity:0; cursor:pointer; }
button:hover{ filter:brightness(1.06); }
button.secondary{ background:#2b315f; }
button.danger{ background:#622b3a; border-color:#a94452; }
input::placeholder{ color:#9aa1cf; }
#visibility-tree details{ margin:6px 0; padding:6px; background:#16183a; border-radius:10px; }
#visibility-tree summary{ cursor:pointer; }
.badge{ display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; margin-left:6px; }
.modal{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,.5); }
.modal.hidden{ display:none; }
.modal-content{ width:520px; max-width:90vw; background:#1a1f43; border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:12px; box-shadow:var(--shadow); }
.small{ padding:6px 8px; font-size:12px; }

/* Sidebar resize handle */
/* Sidebar resizer: higher z-index and pointer-friendly */
#sidebar-resize{
  width: 12px;
  cursor: ew-resize;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border-radius: 8px;
  margin: 0 6px;
  flex: 0 0 12px;
  align-self: stretch;
  touch-action: none;
  position: relative;
  z-index: 9999;          /* MAKE SURE IT IS ABOVE THE SIDEBAR */
  display: block;
}

/* highlight */
.visibility-item{ cursor:pointer; padding:6px 8px; border-radius:8px; display:flex; justify-content:space-between; align-items:center; }
.visibility-item:hover{ background: rgba(255,255,255,0.02); }
.visibility-feature-row.highlight, .visibility-group-summary.highlight{ outline:2px solid rgba(255,255,255,0.06); background:rgba(255,255,255,0.02); }

/* note popover */
#note-popover{ position:absolute; pointer-events:none; background:rgba(20,20,40,0.98); color:#fff; padding:8px 10px; border-radius:8px; font-size:13px; max-width:260px; box-shadow:0 6px 18px rgba(0,0,0,0.5); transform:translate(-50%,-120%); z-index:60; }
#note-popover.hidden{ display:none; }

/* small note indicator in sidebar */
.note-indicator{ font-size:12px; margin-left:8px; opacity:0.9; }

/* ---------- Force-compact visibility tree rows (paste at end of style.css) ---------- */

/* Reduce padding around each details container (outer box) */
#visibility-tree details {
  margin: 2px 0 !important;
  padding: 2px 0 !important;
  background: transparent !important;
}

/* Make the summary very tight and block-level so there's no extra line-height gap */
#visibility-tree summary.visibility-group-summary {
  display: block !important;
  padding: 0 !important;
  margin: 0 !important;
  line-height: 1 !important;
  min-height: 0 !important;
  height: auto !important;
}

/* Hide native summary marker which can add space */
#visibility-tree summary.visibility-group-summary::-webkit-details-marker { display: none; }
#visibility-tree summary.visibility-group-summary::marker { display: none; }

/* The row that actually contains the controls (we created .visibility-item inside the summary).
   Force it to be a tight flex row with small vertical padding. */
#visibility-tree summary.visibility-group-summary > .visibility-item,
.visibility-item {
  display: flex !important;
  align-items: center !important;
  gap: 6px !important;
  padding: 4px 6px !important;   /* reduce top/bottom space here to tighten rows */
  margin: 0 !important;
  line-height: 1 !important;
  font-size: 13px !important;
}

/* Ensure children elements don't introduce extra margins */
#visibility-tree .visibility-item > * { margin: 0 !important; }

/* Tighten the feature rows (entries under each group) */
.visibility-feature-row {
  padding: 3px 6px !important;
  margin: 0 !important;
  line-height: 1 !important;
  font-size: 12px !important;
}

/* If there is still extra blank space coming from the .section wrapper, nudge it down */
#visibility-tree { padding: 2px 4px !important; }


/* Restore a compact custom caret for the group summary */
#visibility-tree summary.visibility-group-summary {
  position: relative;            /* allow absolute caret */
  padding-left: 18px !important; /* room for caret without growing height */
}

/* Small arrow (caret) */
#visibility-tree summary.visibility-group-summary::before {
  content: 'â–¸';                  /* triangle arrow */
  position: absolute;
  left: 4px;
  top: 50%;
  transform: translateY(-50%) rotate(0deg);
  font-size: 12px;
  line-height: 1;
  color: #9aa1cf;                /* muted color */
  transition: transform .12s ease, color .12s ease;
  pointer-events: none;          /* click passes through to summary */
}

/* Rotate caret when details is open */
#visibility-tree details[open] > summary.visibility-group-summary::before {
  transform: translateY(-50%) rotate(90deg);
  color: var(--accent, #9ab0ff);
}

